(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,82309,e=>{"use strict";var s=e.i(77977),r=e.i(6339);function a({onCapture:e,isLoading:a=!1}){let t=(0,r.useRef)(null),n=(0,r.useRef)(null),[l,i]=(0,r.useState)(!1),[o,d]=(0,r.useState)(!1);if((0,r.useEffect)(()=>((async()=>{if("undefined"==typeof navigator||void 0===navigator.mediaDevices||void 0===navigator.mediaDevices.getUserMedia){console.warn("Camera API is not supported in this browser.  Please ensure your browser supports the camera API and that it is enabled."),d(!0),i(!1);return}try{console.log("Requesting camera access...");let e=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});t.current&&(t.current.srcObject=e,i(!0))}catch(e){console.error("Camera access denied:",e),e instanceof DOMException&&console.error("DOMException type:",e.name,e.message),i(!1)}})(),()=>{t.current?.srcObject&&t.current.srcObject.getTracks().forEach(e=>e.stop())}),[]),o){let e="undefined"!=typeof navigator?navigator.userAgent.toLowerCase():"",r=e.includes("brave")&&e.includes("android");return(0,s.jsx)("div",{className:"p-8 text-center border rounded-md",children:(0,s.jsx)("p",{className:"text-red-500 mb-4",children:r?"Camera is not fully supported on this version of Brave for Android. Please try a different browser.":"Camera is not supported on this browser. Please use a different browser."})})}return l?null===l?(0,s.jsx)("div",{className:"p-8 text-center border rounded-md",children:"Requesting camera access..."}):(0,s.jsx)("div",{children:(0,s.jsxs)("div",{className:"p-4 text-center border rounded-md space-y-4",children:[(0,s.jsx)("video",{ref:t,autoPlay:!0,playsInline:!0,className:"mx-auto rounded-md max-w-full"}),(0,s.jsx)("canvas",{ref:n,className:"hidden"}),(0,s.jsx)("button",{type:"button",onClick:()=>{if(n.current&&t.current){let s=n.current.getContext("2d");if(s){let r=(t.current.videoWidth-256)/2,a=(t.current.videoHeight-96)/2;n.current.width=256,n.current.height=96,s.drawImage(t.current,r,a,256,96,0,0,256,96),e(n.current.toDataURL("image/jpeg"))}}},disabled:a,className:"px-4 py-2 rounded-md border disabled:opacity-50",children:a?"Capturing...":"Capture"})]})}):(0,s.jsx)("div",{className:"p-8 text-center border rounded-md",children:(0,s.jsx)("p",{className:"mb-4",children:"Please allow camera permission in your browser."})})}e.s(["CameraCapture",()=>a])},24265,e=>{"use strict";var s=e.i(77977),r=e.i(29694),a=e.i(6339),t=e.i(26072),n=e.i(17495),l=e.i(82309);function i(){let e=(0,r.useRouter)(),[i,o]=(0,a.useState)("details"),[d,c]=(0,a.useState)({studentName:"John Doe",usn:"1BM19CS001",hostelRoom:"A-201",vehicleNumber:"KA01AB1234"}),[u,m]=(0,a.useState)(null),[x,p]=(0,a.useState)(!1),[h,g]=(0,a.useState)(null),b=e=>{let{name:s,value:r}=e.target;c(e=>({...e,[s]:r}))};async function f(){try{p(!0),g(null);let s=await fetch("/api/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...d,licensePlateImage:u})}),r=await s.json();if(!s.ok||!r.success)throw Error(r.message||"Failed to register");e.push("/dashboard")}catch(e){console.error("Confirm registration failed:",e),g(e?.message||"Something went wrong")}finally{p(!1)}}return(0,s.jsx)("main",{className:"min-h-screen bg-gradient-to-b from-background to-muted py-12",children:(0,s.jsxs)("div",{className:"max-w-2xl mx-auto px-4",children:[(0,s.jsxs)("div",{className:"mb-12",children:[(0,s.jsx)("h1",{className:"text-4xl font-bold text-foreground mb-2",children:"Register Your Vehicle"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Complete the registration process to allow your vehicle access to campus parking."})]}),(0,s.jsxs)("div",{className:"flex gap-4 mb-8",children:[(0,s.jsx)("div",{className:`flex-1 h-2 rounded-full ${"details"===i||"camera"===i||"preview"===i?"bg-primary":"bg-muted"}`}),(0,s.jsx)("div",{className:`flex-1 h-2 rounded-full ${"camera"===i||"preview"===i?"bg-primary":"bg-muted"}`}),(0,s.jsx)("div",{className:`flex-1 h-2 rounded-full ${"preview"===i?"bg-primary":"bg-muted"}`})]}),"details"===i&&(0,s.jsxs)(n.Card,{className:"p-8 space-y-6",children:[(0,s.jsx)("h2",{className:"text-2xl font-semibold",children:"Student Information"}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Full Name"}),(0,s.jsx)("input",{type:"text",name:"studentName",value:d.studentName,onChange:b,placeholder:"Enter your full name",className:"w-full px-4 py-2 rounded-lg border border-input bg-background focus:outline-none focus:ring-2 focus:ring-primary"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"USN (University Serial Number)"}),(0,s.jsx)("input",{type:"text",name:"usn",value:d.usn,onChange:b,placeholder:"e.g., 1BM19CS001",className:"w-full px-4 py-2 rounded-lg border border-input bg-background focus:outline-none focus:ring-2 focus:ring-primary"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Hostel Room Number"}),(0,s.jsx)("input",{type:"text",name:"hostelRoom",value:d.hostelRoom,onChange:b,placeholder:"e.g., A-201",className:"w-full px-4 py-2 rounded-lg border border-input bg-background focus:outline-none focus:ring-2 focus:ring-primary"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Vehicle Number / Registration Plate"}),(0,s.jsx)("input",{type:"text",name:"vehicleNumber",value:d.vehicleNumber,onChange:b,placeholder:"e.g., KA01AB1234",className:"w-full px-4 py-2 rounded-lg border border-input bg-background focus:outline-none focus:ring-2 focus:ring-primary"})]})]}),(0,s.jsx)(t.Button,{onClick:()=>o("camera"),disabled:!d.studentName||!d.usn||!d.hostelRoom||!d.vehicleNumber,className:"w-full bg-primary hover:bg-primary/90",size:"lg",children:"Next: Capture License Plate"})]}),"camera"===i&&(0,s.jsxs)(n.Card,{className:"p-8 space-y-6",children:[(0,s.jsx)("h2",{className:"text-2xl font-semibold",children:"Capture License Plate"}),(0,s.jsx)(l.CameraCapture,{onCapture:e=>{m(e),o("preview")},isLoading:x}),(0,s.jsx)(t.Button,{onClick:()=>o("details"),variant:"outline",className:"w-full",size:"lg",children:"Back"})]}),"preview"===i&&u&&(0,s.jsxs)(n.Card,{className:"p-8 space-y-6",children:[(0,s.jsx)("h2",{className:"text-2xl font-semibold",children:"Review & Confirm"}),(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"bg-muted p-6 rounded-lg space-y-4",children:[(0,s.jsx)("h3",{className:"font-semibold text-lg",children:"Student Details"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-muted-foreground",children:"Name"}),(0,s.jsx)("p",{className:"font-medium",children:d.studentName})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-muted-foreground",children:"USN"}),(0,s.jsx)("p",{className:"font-medium",children:d.usn})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-muted-foreground",children:"Hostel Room"}),(0,s.jsx)("p",{className:"font-medium",children:d.hostelRoom})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-muted-foreground",children:"Vehicle Number"}),(0,s.jsx)("p",{className:"font-medium",children:d.vehicleNumber})]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-muted-foreground mb-2",children:"Captured License Plate"}),(0,s.jsx)("img",{src:u||"/placeholder.svg",alt:"License Plate",className:"w-full rounded-lg border border-border"})]})]}),(0,s.jsxs)("div",{className:"flex gap-4",children:[(0,s.jsx)(t.Button,{onClick:()=>o("camera"),variant:"outline",className:"flex-1",size:"lg",children:"Recapture"}),(0,s.jsx)(t.Button,{onClick:f,disabled:x,className:"flex-1 bg-primary hover:bg-primary/90",size:"lg",children:x?"Registering...":"Confirm Registration"})]}),h&&(0,s.jsx)("p",{className:"text-red-500 text-sm mt-4",children:h})]})]})})}e.s(["default",()=>i])}]);